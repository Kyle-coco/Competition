## 药物属性预测

### 摘要

#### 本研究旨在探讨图表示学习在药物分子分类中的应用，结合人工提取特征、经典机器学习算法和图神经网络模型。我们针对药物分子分类的三个问题，分别构建了传统机器学习模型、图卷积网络（GCN）模型和图注意力网络（GAT）模型，并对它们的分类精度进行了评估。

### 问题重述
### 问题1：利用传统方法建立药物分子的分类模型

本问题旨在利用传统的机器学习方法建立药物分子分类模型，并评估其分类精度。通过加载附件中的图数据进行训练和测试，最后分析模型的性能并给出分类精度结果。

### 问题2：基于图神经网络的药物分子分类模型

针对传统药物分子分类方法耗时耗力且难以处理大规模分子数据的局限性，本问题要求设计并实现一个图神经网络模型，用于对附件中的数据进行分类，并评估模型的分类精度。

### 问题3：改进的图神经网络模型应对节点特征稀疏性和信息冗余问题

为解决现有图神经网络模型在处理节点特征稀疏性和信息冗余问题时面临的挑战，本问题要求设计并实现一种新的药物分子分类方法，克服这些限制，并对实验结果进行分析和讨论。

### 实验结果

### 问题1：传统方法分类模型

针对问题1，我们采用传统机器学习方法构建了药物分子分类模型。该模型首先通过图的特征工程，包括计算图的密度、集聚系数和最短路径长度等，提取分子的特征 。然后，引入Node2Vec库提取节点的嵌入，进一步增强特征表示 。这些方法共同构建了一个特征矩阵，并使用随机森林分类器进行训练和测试 。

实验结果显示，模型的分类精度为 **0.7105** 。详细的分类报告如下 ：

|类别|precision|recall|f1-score|support|
|-|-|-|-|-|
|-1|0.62|0.38|0.48|13|
|1|0.73|0.88|0.80|25|
|accuracy|||0.71|38|
|macro avg|0.68|0.63|0.64|38|
|weighted avg|0.70|0.71|0.69|38|

### 问题2：基于图神经网络的药物分子分类模型（GCN）

针对问题2，我们采用了图卷积网络（GCN）对药物分子进行分类 。模型通过捕捉节点间的依赖关系来提升分类精度 。我们从数据文件中加载并解析了分子的邻接矩阵、节点标签和图标签，以适配GCN模型 。数据集被划分为训练集和测试集，用于评估模型性能 。

实验结果表明，GCN模型在训练10个周期后的分类精度如下 ：

-   **训练集准确度 (Train Acc): 0.666667**
    
-   **测试集准确度 (Test Acc): 0.657895**
    

### 问题3：改进的图神经网络模型（GAT）

针对问题3，我们采用了图注意力网络（GAT）模型对药物分子进行分类 。该模型利用图卷积层捕捉分子图中节点间的依赖关系，并通过这些关系对整个分子图进行精确分类. 数据集被划分为训练集和测试集，以便在未见过数据上评估模型性能.

实验结果显示，GAT模型在训练20个周期后的分类精度如下 ：

-   **训练集准确度 (Train Acc): 0.6579**
    
-   **测试集准确度 (Test Acc): 0.6579**

## 模型评价

### 模型优点

1.  **结合实际与简化处理**：模型充分结合实际，简化了数据处理和特征提取步骤，考虑了图的密度、平均集聚系数和平均最短路径长度等重要因素，使得模型合理且具有较高的应用价值，可推广到其他类似图分类问题 。
    
2.  **经典算法的有效运用**：模型运用了支持向量机（SVM）和随机森林（Random Forest）这两种经典的机器学习算法，抓住了影响图分类的重要因素，将复杂的图分类问题转化为简单的数学问题。合理设置SVM的核函数和随机森林的参数，使得模型输出结果符合题目要求，能够解决实际问题 。
    
3.  **Node2Vec算法的优势**：本文使用的Node2Vec算法具有可扩展性、可调整性和高效性等优点，非常适用于求解图的嵌入表示。同时，使用随机森林作为分类器，可以充分利用嵌入表示的特征，提高分类性能 。
    
4.  **高效与稳定**：本文得到的分类方案具有效率高、输出稳定、分类均衡等特点，基本不存在过拟合、欠拟合等问题，在现有条件下能够有效提高生产效率 。
    

### 模型缺点

1.  **因素考虑不全**：实际应用中，节点的度数分布和图的连通性等因素可能也是重要的影响因素，但本文未能充分考虑到这些因素的影响，一定程度上影响了模型的准确性 。
    
2.  **通用性待验证**：本文提出的模型对于现有条件使用效果较好，但由于时间问题，没有对其他情况进行检验。对于其他情形（如：节点的度数分布不同，图的连通性不同），可能无法达到较好的效果 。
    
3.  **非线性关系处理不足**：实际上节点的度数分布和图的连通性的影响不一定是线性的，而本文将其作为线性因子处理，忽略了边际效应的影响 。
